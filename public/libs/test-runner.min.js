const t={BeforeAll:"beforeall",AfterAll:"afterall",BeforeTest:"beforetest",AfterTest:"aftertest",BeforeHook:"beforehook",AfterHook:"afterhook",Cancel:"cancel",Context:"context",Reset:"reset",TestEnd:"testend",Init:"init",Enabled:"enabled",PromptInject:"promptinject",PromptResult:"promptresult"},e="code-test";class n extends HTMLElement{state={testId:"",description:"none",isDisabled:!1,testState:void 0,beforeEachState:void 0,afterEachState:void 0};setState(t){this.state=t,this.#t()}setStateProperties(t){this.setState({...this.state,...t})}setTestStateProperties(t,e){null!=this.state[t]&&this.setState({...this.state,[t]:{...this.state[t],...e}})}findElement(t){return this.querySelector(t)}findElements(t){return Array.from(this.querySelectorAll(t))}isRunning(){return 1==this.state.testState?.isRunning||1==this.state.beforeEachState?.isRunning||1==this.state.afterEachState?.isRunning}hasRun(){return 1==this.state.testState?.hasRun||1==this.state.beforeEachState?.hasRun||1==this.state.afterEachState?.hasRun}resultCategory(){const t=this.state.testState?.resultCategory??"none",e=this.state.beforeEachState?.resultCategory??"none",n=this.state.afterEachState?.resultCategory??"none";return"none"==t&&"none"==e&&"none"==n?"none":null==this.state.beforeEachState&&null==this.state.afterEachState?t:null!=this.state.beforeEachState&&null==this.state.afterEachState?"fail"==t||"fail"==e?"fail":"success"==t&&"success"==e?"success":"none":null==this.state.beforeEachState&&null!=this.state.afterEachState?"fail"==t||"fail"==n?"fail":"success"==t&&"success"==n?"success":"none":null!=this.state.beforeEachState&&null!=this.state.afterEachState?"fail"==t||"fail"==e||"fail"==n?"fail":"success"==t&&"success"==e&&"success"==n?"success":"none":void 0}connectedCallback(){this.#t()}#t(){const t=null==this.state.testState?"":"boolean"==typeof this.state.testState.resultContent?1==this.state.testState.resultContent?'<code class="code" part="code"><pre class="pre success-message" part="pre success-message">Passed</pre></code>':'<code class="code" part="code"><pre class="pre error-message" part="pre error-message">Failed</pre></code>':"number"==typeof this.state.testState.resultContent?`<code class="code" part="code"><pre class="pre success-message" part="pre success-message">Passed: ${this.state.testState.resultContent.toString()}</pre></code>`:"string"==typeof this.state.testState.resultContent?this.state.testState.resultContent:"";this.innerHTML=`<details class="test-details" part="test-details" ${1==this.isRunning()||1==this.hasRun()?" open":""}>\n            <summary class="test-summary" part="test-summary">\n                <svg class="icon arrow-icon"><use href="#icon-definition_arrow"></use></svg>\n                <div class="result-icon test-result-icon${"none"!=this.state.testState?.resultCategory?` ${this.state.testState?.resultCategory}`:""}" part="result-icon"></div>\n                <span class="test-description description" title="${this.state.description}">${this.state.description}</span>\n                ${null!=this.state.testState?.duration&&this.state.testState.duration>0?`<span class="test-duration duration">\n                        <span class="test-duration-value">${this.state.testState.duration>10?this.state.testState.duration.toFixed(0):this.state.testState.duration.toFixed(2)}</span>\n                        <span class="test-duration-unit">ms</span>\n                    </span>`:""}\n                <button type="button" class="run-test-button" part="run-test-button" title="Run Test"${1==this.state.isDisabled?" disabled":""}>\n                    <slot name="run-button-content">\n                        <slot name="run-button-icon"><svg class="icon arrow-icon run-button-icon"><use href="#icon-definition_arrow"></use></svg></slot>\n                        <slot name="run-button-label"><span class="run-button-label button-label label icon">Run Test</span></slot>\n                    </slot>\n                </button>\n            </summary>\n            <div class="results" part="results">\n                ${null==this.state.beforeEachState?"":`<details class="before-each-details hook${"none"==this.state.beforeEachState.resultCategory?"":` ${this.state.beforeEachState.resultCategory}`}${1==this.state.beforeEachState.isRunning?" running":""}" part="before-each-details hook">\n                        <summary class="before-each-summary" part="before-each-summary">\n                            <svg class="icon arrow-icon"><use href="#icon-definition_arrow"></use></svg>\n                            <div class="before-each-result-icon result-icon${"none"!=this.state.beforeEachState.resultCategory?` ${this.state.beforeEachState.resultCategory}`:""}" part="before-each-result-icon"></div>\n                            <span class="before-each-description description hook-name">Before Each Hook</span>\n                        </summary>\n                        <div class="before-each-result result message" part="before-each-result result message">${"string"!=typeof this.state.beforeEachState.resultContent?"":this.state.beforeEachState.resultContent}</div>\n                    </details>`}\n                ${null==this.state.testState?"":null==this.state.beforeEachState&&null==this.state.afterEachState?`<div class="test-result result message" part="test-result result message">${t}</div>`:`<details class="processing-details${"none"==this.state.testState.resultCategory?"":` ${this.state.testState.resultCategory}`}${1==this.state.testState.isRunning?" running":""}" part="processing-details"${1==this.state.testState.hasRun?" open":""}>\n                        <summary class="processing-summary" part="processing-summary">\n                            <svg class="icon arrow-icon"><use href="#icon-definition_arrow"></use></svg>\n                            <div class="processing-result-icon result-icon${"none"!=this.state.testState.resultCategory?` ${this.state.testState.resultCategory}`:""}" part="processing-result-icon result-icon"></div>\n                            <span class="processing-description description">Test</span>\n                        </summary>\n                        <div class="test-result result message" part="test-result result message">${t}</div>\n                    </details>`}                \n                ${null==this.state.afterEachState?"":`<details class="after-each-details hook${"none"==this.state.afterEachState.resultCategory?"":` ${this.state.afterEachState.resultCategory}`}${1==this.state.afterEachState.isRunning?" running":""}" part="after-each-detail hooks">\n                        <summary class="after-each-summary" part="after-each-summary">\n                            <svg class="icon arrow-icon"><use href="#icon-definition_arrow"></use></svg>\n                            <div class="after-each-result-icon result-icon${"none"!=this.state.afterEachState.resultCategory?` ${this.state.afterEachState.resultCategory}`:""}" part="before-each-result-icon"></div>\n                            <span class="after-each-description description hook-name">After Each Hook</span>\n                        </summary>\n                        <div class="after-each-result result message" part="after-each-result result message">${"string"!=typeof this.state.afterEachState.resultContent?"":this.state.afterEachState.resultContent}</div>\n                    </details>`}\n            </div>\n        </details>`,this.dataset.testId=this.state.testId,this.classList.add("test"),this.part.add("test"),this.toggleAttribute("success","success"==this.resultCategory()),this.classList.toggle("success","success"==this.resultCategory()),this.part.toggle("success","success"==this.resultCategory()),this.classList.toggle("fail","fail"==this.resultCategory()),this.part.toggle("fail","fail"==this.resultCategory()),this.classList.toggle("running",this.isRunning()),this.part.toggle("running",this.isRunning()),this.state.beforeEachState?.resultContent instanceof HTMLElement&&this.querySelector(".before-each-result").append(this.state.beforeEachState.resultContent),this.state.testState?.resultContent instanceof HTMLElement&&this.querySelector(".test-result").append(this.state.testState.resultContent),this.state.afterEachState?.resultContent instanceof HTMLElement&&this.querySelector(".after-each-result").append(this.state.afterEachState.resultContent)}enable(){this.state.isDisabled=!1,this.findElement(".run-test-button").toggleAttribute("disabled",!1)}disable(){this.state.isDisabled=!0,this.findElement(".run-test-button").toggleAttribute("disabled",!0)}async runTest(e,n){if(null==this.state.testState?.test)return;let s;this.reset();let r={},a=0;try{if(0==e.shouldContinueRunningTests)throw new Error("Tests have been disabled from continuing to run.");if(0==this.dispatchEvent(new CustomEvent(t.BeforeTest,{bubbles:!0,cancelable:!0,composed:!0,detail:{testElement:this}})))throw new Error("Test has been prevented.");if(1==n.codeTestsElement.state.isCanceled)throw new Error("Testing has been canceled.");this.setTestStateProperties("testState",{isRunning:!0}),e.codeTestsElement.setState(e.codeTestsElement.state);const o=performance?.now()??Date.now();s=await this.state.testState.test(n);a=(performance?.now()??Date.now())-o,this.setTestStateProperties("testState",{isRunning:!1,hasRun:!0}),e.codeTestsElement.setState(e.codeTestsElement.state);const i=e.parseTestResult(s,!0);r={testState:{test:this.state.testState.test,resultContent:i.result,resultCategory:i.resultCategory,hasRun:this.state.testState.hasRun,isRunning:!1,duration:a}}}catch(t){const n=e.parseTestResult(s,!1,t);r={testState:{test:this.state.testState.test,resultContent:n.result,resultCategory:n.resultCategory,hasRun:this.state.testState.hasRun,isRunning:!1,duration:a}},console.error(t),e.shouldContinueRunningTests=!1}finally{this.setStateProperties({...r}),e.codeTestsElement.setState(e.codeTestsElement.state),this.dispatchEvent(new CustomEvent(t.AfterTest,{bubbles:!0,cancelable:!0,composed:!0,detail:{testElement:this}}))}}reset(){const t=null!=this.state.testState?{resultCategory:"none",resultContent:"",test:this.state.testState.test,hasRun:this.state.testState.hasRun,isRunning:this.state.testState.isRunning,duration:0}:void 0;null!=t&&this.setTestStateProperties("testState",t)}getMessageElement(){return this.findElement(".test-result")}static observedAttributes=["open"];attributeChangedCallback(t,e,n){"open"==t&&this.findElement(".test-details").toggleAttribute("open",null!=n)}}null==customElements.get(e)&&customElements.define(e,n);const s=Symbol("No Test Defined");class r{codeTestsElement;constructor(t){this.codeTestsElement=t}async loadTests(t){if(null!=t)try{const{tests:e,hooks:n}=await this.#e(t),s=n[l.BeforeAll],r=n[l.AfterAll],a=n[l.BeforeEach],o=n[l.AfterEach],i=n[l.RequiredBeforeAny],c=n[l.RequiredAfterAny],u=null==s?void 0:{resultCategory:"none",resultContent:"",test:s,hasRun:!1,isRunning:!1,duration:0},d=null==r?void 0:{resultCategory:"none",resultContent:"",test:r,hasRun:!1,isRunning:!1,duration:0},h=null==a?void 0:{resultCategory:"none",resultContent:"",test:a,hasRun:!1,isRunning:!1,duration:0},p=null==o?void 0:{resultCategory:"none",resultContent:"",test:o,hasRun:!1,isRunning:!1,duration:0},f=null==i?void 0:{resultCategory:"none",resultContent:"",test:i,hasRun:!1,isRunning:!1,duration:0},g=null==c?void 0:{resultCategory:"none",resultContent:"",test:c,hasRun:!1,isRunning:!1,duration:0};this.codeTestsElement.state.beforeEachState=h,this.codeTestsElement.state.afterEachState=p;for(const[t,n]of Object.entries(e))this.#n(t,n);this.codeTestsElement.setStateProperties({beforeAllState:u,afterAllState:d,beforeEachState:h,afterEachState:p,requiredBeforeAnyState:f,requiredAfterAnyState:g,resetHook:n.reset,contextHook:n.context})}catch(t){console.error(t)}}async#e(t){const e=await this.#s(t),n=e.tests??e.default;if(null==n)throw new Error(`Unable to find tests definition in file at path: ${t}`);const s={},r=n[l.BeforeAll];null!=r&&(s[l.BeforeAll]=r,delete n[l.BeforeAll]);const a=n[l.AfterAll];null!=a&&(s[l.AfterAll]=a,delete n[l.AfterAll]);const o=n[l.BeforeEach];null!=o&&(s[l.BeforeEach]=o,delete n[l.BeforeEach]);const i=n[l.AfterEach];null!=i&&(s[l.AfterEach]=i,delete n[l.AfterEach]);const c=n[l.RequiredBeforeAny];null!=c&&(s[l.RequiredBeforeAny]=c,delete n[l.RequiredBeforeAny]);const u=n[l.RequiredAfterAny];null!=u&&(s[l.RequiredAfterAny]=u,delete n[l.RequiredAfterAny]);const d=n[l.Reset];null!=d&&(s[l.Reset]=d,delete n[l.Reset]);const h=n[l.Context];return null!=h&&(s[l.Context]=h,delete n[l.Context]),{tests:n,hooks:s}}async#s(t){const e=window.location.href.lastIndexOf("/"),n=1==(-1!=window.location.href.substring(e).indexOf("."))?window.location.href.substring(0,e+1):window.location.href,s=n+t.substring(0,t.lastIndexOf("/")+1),r=n+t;let a=await(await fetch(r)).text();a=a.replaceAll(/['"`](((\.\/)|(\.\.\/))+(.*))['"`]/g,`'${s}$1'`);const o=new File([a],t.substring(t.lastIndexOf("/")),{type:"text/javascript"}),i=URL.createObjectURL(o);return await import(i)}#n(t,e){const s=function(){const t=new Uint8Array(20);crypto.getRandomValues(t);const e=[].slice.apply(t).map(function(t){return String.fromCharCode(t)}).join("");return btoa(e).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}(),r=new n;return r.setStateProperties({testId:s,description:t,testState:{test:e,resultCategory:"none",resultContent:"",isRunning:!1,hasRun:!1,duration:0},beforeEachState:null==this.codeTestsElement.state.beforeEachState?void 0:{isRunning:this.codeTestsElement.state.beforeEachState.isRunning,hasRun:this.codeTestsElement.state.beforeEachState.hasRun,resultCategory:this.codeTestsElement.state.beforeEachState.resultCategory,resultContent:this.codeTestsElement.state.beforeEachState.resultContent,duration:0},afterEachState:null==this.codeTestsElement.state.afterEachState?void 0:{isRunning:this.codeTestsElement.state.afterEachState.isRunning,hasRun:this.codeTestsElement.state.afterEachState.hasRun,resultCategory:this.codeTestsElement.state.afterEachState.resultCategory,resultContent:this.codeTestsElement.state.afterEachState.resultContent,duration:0}}),this.codeTestsElement.findElement("#tests").append(r),s}shouldContinueRunningTests=!0;async runTests(e){if(0==this.codeTestsElement.dispatchEvent(new CustomEvent(t.BeforeAll,{bubbles:!0,composed:!0,cancelable:!0})))throw new Error("Tests have been prevented.");await this.codeTestsElement.reset();for(let t=0;t<e.length;t++)e[t].disable();const n=await this.createTestContext();if(await this.runHook("requiredBeforeAnyState",void 0,n),0==this.shouldContinueRunningTests)return void await this.#r(e,n);if(await this.runHook("beforeAllState",void 0,n),0==this.shouldContinueRunningTests)return void await this.#r(e,n);if(0==("false"!=this.codeTestsElement.getAttribute("ordered"))){const t=e.map(t=>this.runTest(t,!0,n));await Promise.all(t)}else for(let t=0;t<e.length;t++){const s=e[t];if(0==this.shouldContinueRunningTests)break;await this.runTest(s,!0,n)}0!=this.shouldContinueRunningTests?(await this.runHook("afterAllState",void 0,n),await this.#r(e,n)):await this.#r(e,n)}async#r(e,n){await this.runHook("requiredAfterAnyState",void 0,n);for(let t=0;t<e.length;t++)e[t].enable();this.codeTestsElement.dispatchEvent(new CustomEvent(t.AfterAll,{bubbles:!0,composed:!0}))}async runTest(t,e,n){if(null!=t){if(0==e){const t=this.codeTestsElement.findElements("code-test");for(let e=0;e<t.length;e++)t[e].disable()}null==(n=n??await this.createTestContext(t)).testElement&&(n.testElement=t),0!=e||(await this.runHook("requiredBeforeAnyState",void 0,n),0!=this.shouldContinueRunningTests)?(await this.runHook("beforeEachState",t,n),0!=this.shouldContinueRunningTests?(await t.runTest(this,n),0!=this.shouldContinueRunningTests?(await this.runHook("afterEachState",t,n),await this.#a(n,e)):await this.#a(n,e)):await this.#a(n,e)):await this.#a(n,e)}}async#a(e,n){if(1==n)return;await this.runHook("requiredAfterAnyState",void 0,e);const s=this.codeTestsElement.findElements("code-test");for(let t=0;t<s.length;t++)s[t].enable();this.codeTestsElement.dispatchEvent(new CustomEvent(t.TestEnd,{bubbles:!0,composed:!0,cancelable:!0,detail:{target:this}}))}async runHook(e,n,r){const a=this.codeTestsElement.state[e];if(null==a)return s;if(1==this.codeTestsElement.state.isCanceled)return{success:!1,value:"Testing has been canceled."};let o;try{if(0==this.shouldContinueRunningTests&&("requiredAfterAnyState"!=e||"error"==this.codeTestsElement.getAttribute("required-after")))throw new Error("Tests have been disabled from continuing to run.");null!=n&&n.setTestStateProperties(e,{isRunning:!0}),this.codeTestsElement.setTestStateProperties(e,{isRunning:!0}),o=await a.test(r),null!=n&&n.setTestStateProperties(e,{isRunning:!1,hasRun:!0}),this.codeTestsElement.setTestStateProperties(e,{isRunning:!1,hasRun:!0});const t=this.parseTestResult(o,!0,void 0);null!=n&&n.setTestStateProperties(e,{resultCategory:t.resultCategory,resultContent:t.result}),this.codeTestsElement.setTestStateProperties(e,{resultCategory:t.resultCategory,resultContent:t.result})}catch(t){console.error(t),this.shouldContinueRunningTests=!1,o={success:!1,value:`Failed: ${t.message}`};const s=this.parseTestResult(o,!1,t);null!=n&&n.setTestStateProperties(e,{isRunning:!1,hasRun:!0,resultContent:s.result,resultCategory:s.resultCategory}),this.codeTestsElement.setTestStateProperties(e,{isRunning:!1,hasRun:!0,resultCategory:s.resultCategory,resultContent:s.result})}finally{return this.codeTestsElement.dispatchEvent(new CustomEvent(t.AfterHook,{bubbles:!0,composed:!0,detail:o})),o}}parseTestResult(t,e,n){if(t==s)return{result:"",resultCategory:"none"};if(null==t){const t=1==e?"success-message":"error-message";return{result:`<code class="code" part="code">\n                    <pre class="pre ${t}" part="pre ${t}">${1==e?"Passed":"Failed"+(null!=n?`:\n${n.message}`:"")}</pre>\n                </code>`,resultCategory:1==e?"success":"fail"}}if("boolean"==typeof t)return{result:t,resultCategory:1==t?"success":"fail"};if("function"==typeof t)return console.log("function"),{result:"[A function was returned]",resultCategory:"none"};if(t instanceof HTMLElement||"string"==typeof t)return{result:t,resultCategory:"none"};if("object"==typeof t){const n=t,s=1==e?"success-message":"error-message";if(null!=n.success&&null!=n.expected&&null!=n.value)return{result:`<code class="code" part="code">\n                        <pre class="pre ${s}" part="pre ${s}">${1==n.success?"Passed":"Failed"}\nExpected:${n.expected}\nResult:${n.value}</pre>\n                    </code>`,resultCategory:1==n.success?"success":"fail"};if(null!=n.success)return{result:`<code class="code" part="code">\n                        <pre class="pre ${s}" part="pre ${s}">${JSON.stringify(t,void 0,2)}</pre>\n                    </code>`,resultCategory:1==n.success?"success":"fail"};{const n=1==e?"success-message":"error-message";return{result:`<code class="code" part="code">\n                        <pre class="pre ${n}" part="pre ${n}">${JSON.stringify(t,void 0,2)}</pre>\n                    </code>`,resultCategory:1==e?"success":"fail"}}}throw new Error("Unable to parse result type: Unknown result type")}async createTestContext(e){const n={detail:{},codeTestsElement:this.codeTestsElement,testElement:e};return null!=this.codeTestsElement.state.contextHook&&await this.codeTestsElement.state.contextHook(n),this.codeTestsElement.dispatchEvent(new CustomEvent(t.Context,{bubbles:!0,composed:!0,detail:{context:n}})),n}}class a extends Promise{async toBeDefined(t){if(null==await(this))throw new Error(`${null!=t?t:"Value"} is undefined`)}async toBe(t,e=!1){const n=await(this);if(0==(1==e?n===t:n==t))throw new Error(`  Value is not equal.\n  Expected: ${t}\n  Result: ${n}`)}async toContainText(t){const e=await(this);return e instanceof HTMLElement?{success:e.textContent.includes(t),index:e.textContent.indexOf(t)}:"string"==typeof e&&{success:e.includes(t),index:e.indexOf(t)}}async toHaveAttribute(t){const e=await(this);if(!(e instanceof HTMLElement))throw new Error("Unable to check for attribute on non-HTMLElement target");if(e.getAttribute(t))throw new Error("Target does not have attribute")}}const o=":not(slot,defs,g,rect,path,circle,ellipse,line,polygon,text,tspan,use,svg image,svg title,desc,template,template *)";function i(t){!function(t){const e=[...t.querySelectorAll(`${o}[id]`)];for(let t=0;t<e.length;t++)e[t].part.add(e[t].id)}(t),function(t){const e=[...t.querySelectorAll(`${o}[class]`)];for(let t=0;t<e.length;t++)e[t].part.add(...e[t].classList)}(t)}const l={BeforeAll:"beforeall",AfterAll:"afterall",BeforeEach:"beforeeach",AfterEach:"aftereach",RequiredBeforeAny:"requiredbeforeany",RequiredAfterAny:"requiredafterany",Reset:"reset",Context:"context"},c=new CSSStyleSheet;c.replaceSync(":host\n{\n    --gap: 7px;\n    --gap-small: 3px;\n    --gap-medium: 14px;\n    --gap-large: 24px;\n    \n    --surface-success: oklch(93.96% 0.05 148.74);\n    --primary-success: oklch(58.83% 0.158 145.05);\n    --border-success: solid 1px var(--primary-success);\n\n    --surface-fail: oklch(88.98% 0.052 3.28);\n    --primary-fail: oklch(45.8% 0.177 17.7);\n    --border-fail: solid 1px var(--primary-fail);\n\n    --surface-process: oklch(89.66% 0.046 260.67);\n    --primary-process: oklch(43.48% 0.17 260.2);\n    --border-process: solid 1px var(--primary-process);\n\n\n    --surface-footer: rgb(0 0 0 / .04);\n    \n    --success-icon: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path fill=\"%232e943a\" d=\"M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z\"/></svg>');\n    --info-icon: url('data:image/svg+xml,%3Csvg%20viewBox%3D%220%200%2022.812714%2022.814663%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20style%3D%22fill%3Atransparent%3Bstroke%3Atransparent%3Bstroke-width%3A0.999999%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A6.3%3Bstroke-dasharray%3Anone%3Bstroke-dashoffset%3A29.2913%3Bstroke-opacity%3A1%22%20d%3D%22M%2022.295505%2C11.407332%20A%2010.889144%2C10.889144%200%200%201%2011.406424%2C22.296479%2010.889144%2C10.889144%200%200%201%200.51720881%2C11.407332%2010.889144%2C10.889144%200%200%201%2011.406424%2C0.51818382%2010.889144%2C10.889144%200%200%201%2022.295505%2C11.407332%20Z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22m%2013.945668%2C4.3053761%20c%200.150778%2C-0.96462%20-0.30687%2C-1.43709%20-1.36997%2C-1.43709%20-1.063%2C0%20-1.668452%2C0.47247%20-1.81923%2C1.43709%20-0.150779%2C0.96462%200.306971%2C1.43708%201.369971%2C1.43708%201.004%2C0%201.66845%2C-0.47246%201.819229%2C-1.43708%20z%20M%2011.693889%2C17.829726%2013.373994%2C7.0811161%20h%20-2.9333%20L%208.7605887%2C17.829726%20Z%22%20style%3D%22font-size%3A19.6861px%3Bfont-family%3APassageway%3B-inkscape-font-specification%3APassageway%3Bfill%3A%23a30d30%3Bstroke-width%3A2.5%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A6.3%3Bstroke-dashoffset%3A29.2913%22%20aria-label%3D%22i%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E');\n\n\n    display: grid;\n    gap: var(--gap);\n    grid-auto-rows: max-content;\n    font-family: sans-serif;\n    font-size: 12px;\n}\n@media (prefers-color-scheme: dark) \n{\n    :host\n    {\n        --surface-footer: rgb(255 255 255 / .1);\n    }\n}\n\n#header\n{\n    flex: 1;\n    display: flex;\n    align-items: center;\n    gap: var(--gap);\n}\n#title\n{\n    flex: 1;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n#tests\n,#component-content\n{\n    display: grid;\n    gap: var(--gap-small);\n    grid-auto-rows: max-content;\n}\n\n#header button\n{\n    align-self: stretch;\n    display: inline-flex;\n    align-items: center;\n    gap: var(--gap-small);\n}\n\nbutton .reset-icon\n{\n    width: 1em;\n    height: 1em;\n    transform: scaleX(-1);\n    margin-inline: 3px;\n}\n\n/* Run button */\nbutton .arrow-icon\n{\n    width: .75em;\n    height: .75em;\n    transform: rotate(-90deg);\n    margin-inline: 3px;\n}\n:host(.running) .run-all-button-icon\n,:host(.fail) .run-all-button-icon\n{\n    transform: rotate(0);\n}\n\n/* Dropdown Layout */\nsummary > .run-test-button\n, #run-all-button\n{\n    justify-self: flex-end;\n    margin-left: auto;\n}\n\nsummary:not(#component-summary)\n{\n    padding: var(--gap-small);\n}\n#component-summary\n{\n    padding: var(--gap) var(--gap-small);\n    border-bottom: solid 1px;\n    margin-bottom: var(--gap-small);\n}\n\n\n/* Dropdown Markers */\nsummary\n{\n    display: flex;\n    align-items: center;\n    gap: var(--gap);\n}\nsummary > .arrow-icon\n{\n    background: var(--arrow-icon);\n    transform: rotate(-90deg);\n    transition: transform ease-out 90ms;\n    width: .6em;\n    height: .6em;\n}\ndetails[open] > summary > .arrow-icon\n{\n    transform: rotate(0);\n}\n\n#enabled\n{\n    display: none;\n}\n:host([optional]) #enabled\n{\n    display: block;\n}\n\n/* Result Icon */\n.result-icon\n{\n    --background-size: 16px;\n    width: var(--background-size);\n    height: var(--background-size);\n\n    display: flex;\n    align-items: center;\n    justify-content: center;\n\n    border: solid 1px currentColor;\n    border-radius: 50%;\n}\n.result-icon::before\n{\n    content: 'â‹¯';\n    font-size: 10px;\n}\n\n:host(.running) #component-summary .result-icon\n,.test.running .test-summary > .result-icon\n,.hook.running .result-icon\n,.processing-details.running .processing-result-icon\n{\n    border: var(--border-process);\n    background: var(--surface-process);\n}\n:host(.success) #component-summary .result-icon\n,.test.success .test-summary > .result-icon\n,.hook.success .result-icon\n,.processing-details.success .processing-result-icon\n{\n    border: var(--border-success);\n    background: var(--surface-success)\n    var(--success-icon);\n    background-repeat: no-repeat;\n    background-position: center;\n    background-size: var(--icon-size, 12px) var(--icon-size, 12px);\n}\n:host(.fail) #component-summary .result-icon\n,.test.fail .test-summary > .result-icon\n,.hook.fail .result-icon\n,.processing-details.fail .processing-result-icon\n{\n    border: var(--border-fail);\n    background: var(--surface-fail)\n    var(--info-icon);\n    background-size: var(--icon-size, 16px) var(--icon-size, 16px);\n    background-repeat: no-repeat;\n    background-position: center;\n    transform: rotate(175deg);\n}\n:host(:is(.success,.fail)) #component-summary .result-icon::before\n,.test:is(.success,.fail) .test-summary > .result-icon::before\n,.hook:is(.success,.fail) .result-icon::before\n,.processing-details:is(.success,.fail) .processing-result-icon::before\n{\n    display: none;\n}\n:host(.running) #component-summary .result-icon::before\n,.test:is(.running) .test-summary > .result-icon::before\n,.hook:is(.running) .result-icon::before\n,.processing-details:is(.running) .processing-result-icon::before\n{\n    content: '';\n    --color: var(--primary-process, currentColor);\n    --animation-timing-function: linear;\n    --animation-duration: 2s;\n    width: var(--icon-size, 14px);\n    height: var(--icon-size, 14px);\n    mask-image: radial-gradient(circle at 50% 50%, transparent calc(var(--icon-size, 14px) / 3), black calc(var(--icon-size, 14px) / 3));\n    background-image: conic-gradient(transparent, transparent 135deg, var(--color));\n    border-radius: 50%;\n    animation: var(--animation-timing-function) var(--animation-duration) infinite spin;\n    margin: 2px;\n}\n\n/* Smaller Result icon settings for sub-test icons */\n.before-each-result-icon\n,.after-each-result-icon\n,.processing-result-icon\n{\n    --background-size: 12px;\n}\n.before-each-result-icon::before\n,.after-each-result-icon::before\n,.processing-result-icon::before\n{\n    font-size: 9px;\n}\n.hook.success .before-each-result-icon\n,.hook.success .after-each-result-icon\n,.processing-details.success .processing-result-icon\n{\n    --icon-size: 8px;\n}\n.hook.fail .before-each-result-icon\n,.hook.fail .after-each-result-icon\n,.processing-details.fail .processing-result-icon\n{\n    --icon-size: 12px;\n}\n.hook:is(.running) .before-each-result-icon::before\n,.hook:is(.running) .after-each-result-icon::before\n,.processing-details:is(.running) .processing-result-icon::before\n{\n    --icon-size: 9px;\n}\n\n/* Hook Display */\n.hook\n{\n    display: none;\n}\n:host(.has-before-all-hook) #before-all-details\n,:host(.has-after-all-hook) #after-all-details\n{\n    display: initial;\n}\n:host(.has-before-each-hook) .before-each-details\n,:host(.has-after-each-hook) .after-each-details\n{\n    display: initial;\n}\n:host(.has-required-before-hook) #required-before-any-details\n,:host(.has-required-after-hook) #required-after-any-details\n{\n    display: initial;\n}\n\n/* Test Display */\ncode-test .results\n{\n    display: grid;\n    gap: var(--gap-small);\n    padding-inline-start: 1em;\n}\n\ncode-test .results details .result\n,.hook > .results\n{\n    margin-inline-start: 1em;\n}\n\n.result.message:empty\n{\n    padding: .5em 1em;\n}\n.result.message:empty::before\n{\n    content: '[ this function has not been run ]';\n    font-family: monospace;\n    font-size: 12px;\n    font-style: italic;\n}\n\n/* Ordered Display */\n#tests\n{\n    counter-reset: tests;\n}\ncode-test\n{\n    counter-increment: tests;\n}\ncode-test > details > summary > .description\n{\n    flex: 1;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    width: 0; /* hack to make overflow work right; \"contain: inline-size\" is correct fix, but it's too new to implement on jan 25, 2026; */\n}\n:host(:not([ordered=\"false\"])) code-test > details > summary > .description::before\n{\n    content: counter(tests) \". \";\n}\n\n/* Hook Name */\n.hook-name,.processing-description\n{\n    border-radius: 3px;\n    border: solid 1px;\n    font-family: monospace;\n    text-transform: uppercase;\n    font-size: 11px;\n    padding: 3px 7px;\n}\n\n#footer\n{\n    display: flex;\n    justify-content: flex-end;\n    border-top: solid 1px;\n    border-bottom: solid 1px;\n    background: var(--surface-footer);\n    margin-top: var(--gap-small);\n}\n#group-results\n{\n    display: flex;\n    gap: var(--gap);\n    padding: var(--gap);\n}\n\n#results-progress-value\n{\n    min-width: 40px;\n    width: auto;\n}\n\n#duration\n,#passed-total-pair\n,#passed-total-percent\n{\n    white-space: nowrap;\n}\n\n#passed-total-percent::before\n{\n    content: '(';\n}\n#passed-total-percent::after\n{\n    content: ')';\n}\n\n@keyframes spin\n{\n    from { transform: rotate(0deg); }\n    to { transform: rotate(360deg); }\n}");const u="code-tests";class d extends HTMLElement{state={isCanceled:!1,beforeAllState:void 0,afterAllState:void 0,beforeEachState:void 0,afterEachState:void 0,requiredBeforeAnyState:void 0,requiredAfterAnyState:void 0,resetHook:void 0,contextHook:void 0};setState(t){this.state=t,this.#t()}setStateProperties(t){this.setState({...this.state,...t})}setTestStateProperties(t,e){null!=this.state[t]&&this.setState({...this.state,[t]:{...this.state[t],...e}})}findElement(t){return this.shadowRoot.querySelector(t)}findElements(t){return Array.from(this.shadowRoot.querySelectorAll(t))}getIsRunning(){return 1==(null!=this.findElements("code-test").find(t=>1==t.isRunning()))||1==this.state.requiredBeforeAnyState?.isRunning||1==this.state.requiredAfterAnyState?.isRunning||1==this.state.beforeAllState?.isRunning||1==this.state.afterAllState?.isRunning}getResultCategory(){const t=this.findElements("code-test").reduce((t,e,n)=>{const s=e.resultCategory();return"fail"==t||"fail"==s?"fail":"success"!=t&&""!=t||"success"!=s?"none":"success"},""),e=[this.state.requiredBeforeAnyState,this.state.requiredAfterAnyState,this.state.beforeAllState,this.state.afterAllState].reduce((t,e,n)=>{if(null==e)return null;const s=e?.resultCategory;return"fail"==t||"fail"==s?"fail":"success"!=t&&""!=t||"success"!=s?"none":"success"},"");return"none"==t&&null==e?"none":"fail"==t||"fail"==e?"fail":"success"==t||"success"==e?"success":"none"}#o;constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='<details id="component-details" class="details">\n    <summary id="component-summary" class="summary">\n        <svg class="icon arrow-icon"><use href="#icon-definition_arrow"></use></svg>\n        <slot name="header">\n            <header id="header">\n                <span id="component-result-icon" class="result-icon"></span>\n                <slot name="enabled-toggle">\n                    <input type="checkbox" name="enabled" id="enabled" title="Enabled?" checked />\n                </slot>\n                <span id="title"><slot name="title"><span id="title-text">Tests</span></slot></span>\n                <slot name="reload-button">\n                    <button type="button" id="reload-button" title="Reload">\n                        <slot name="reload-button-content">\n                            <slot name="reload-button-icon"><svg class="icon reset-icon reload-button-icon"><use href="#icon-definition_reset"></use></svg></slot>\n                            <slot name="reload-button-label"><span class="reload-button-label button-label label icon">Reload</span></slot>\n                        </slot>\n                    </button>\n                </slot>\n                <slot name="run-all-button">\n                    <button type="button" id="run-all-button" title="Run All Tests">\n                        <slot name="run-all-button-content">\n                            <slot name="run-all-button-icon"><svg class="icon arrow-icon run-button-icon run-all-button-icon"><use href="#icon-definition_arrow"></use></svg></slot>\n                            <slot name="run-all-button-label"><span class="run-all-button-label run-button-label button-label label icon">Run Tests</span></slot>\n                        </slot>\n                    </button>\n                </slot>\n                <slot name="header-details"></slot>\n            </header>\n        </slot>\n    </summary>\n    <div id="component-content" class="content">\n        <details id="required-before-any-details" class="hook">\n            <summary id="required-before-any-summary">\n                <svg class="icon arrow-icon"><use href="#icon-definition_arrow"></use></svg>\n                <span id="required-before-any-result-icon" class="result-icon"></span>\n                <span id="required-before-any-description" class="description hook-name">Required Before Any Hook</span>\n            </summary>\n            <div class="results">\n                <div id="required-before-any-results" class="result message"></div>\n            </div>\n        </details>\n        <details id="before-all-details" class="hook">\n            <summary id="before-all-summary">\n                <svg class="icon arrow-icon"><use href="#icon-definition_arrow"></use></svg>\n                <span id="before-all-result-icon" class="result-icon"></span>\n                <span id="before-all-description" class="description hook-name">Before All Hook</span>\n            </summary>\n            <div class="results">\n                <div id="before-all-results" class="result message"></div>\n            </div>\n        </details>\n        <div id="tests"></div>\n        <details id="after-all-details" class="hook">\n            <summary id="after-all-summary">\n                <svg class="icon arrow-icon"><use href="#icon-definition_arrow"></use></svg>\n                <span id="after-all-result-icon" class="result-icon"></span>\n                <span id="after-all-description" class="description hook-name">After All Hook</span>\n            </summary>\n            <div class="results">\n                <div id="after-all-results" class="result message"></div>\n            </div>\n        </details>\n        <details id="required-after-any-details" class="hook">\n            <summary id="required-after-any-summary">\n                <svg class="icon arrow-icon"><use href="#icon-definition_arrow"></use></svg>\n                <span id="required-after-any-result-icon" class="result-icon"></span>\n                <span id="required-after-any-description" class="description hook-name">Required After Any Hook</span>\n            </summary>\n            <div class="results">\n                <div id="required-after-any-results" class="result message"></div>\n            </div>\n        </details>\n    </div>\n    \n    <slot name="footer">\n        <foooter id="footer">\n            <span id="group-results">\n                <span id="duration">\n                    <span id="duration-label">Duration</span>\n                    <span id="duration-value">0</span>\n                    <span id="duration-unit">ms</span>\n                </span>\n                <span id="results-progress">\n                    <progress id="results-progress-value"></progress>\n                </span>\n                <span id="passed-total-pair">\n                    <span id="total-tests-passed-value"></span>\n                    <span id="passed-total-delimiter">of</span>\n                    <span id="total-tests-count-value"></span>\n                    <span id="total-tests-passed-label">Passed</span>\n                </span>\n                <span id="passed-total-percent">\n                    <span id="passed-total-percent-value">0</span>\n                    <span id="passed-total-percent-label">%</span>\n                </span>\n            </span>\n        </foooter>\n    </slot>\n</details>\n<template id="prompt-template">\n    <div class="prompt">\n        <div class="prompt-display">\n            <span class="icon prompt-icon"></span>\n            <span class="label prompt-label"></span>\n        </div>\n        <div class="prompt-actions">\n            <button class="prompt-button accept" type="button">Accept</button>\n            <button class="prompt-button reject" type="button">Reject</button>\n        </div>\n    </div>\n</template>\n<div id="icon-definitions" style="display: none;">\n    <svg id="icon-definition_arrow" viewBox="0 0 8 8" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">\n        <path d="m3.26,6.81l-2.93,-4.69c-0.37,-0.58 0.05,-1.34 0.74,-1.34l5.87,0c0.69,0 1.11,0.76 0.74,1.34l-2.93,4.69c-0.35,0.55 -1.14,0.55 -1.49,0z" fill="var(--fill-color, currentcolor)" />\n    </svg>\n    <svg id="icon-definition_reset" class="icon reset" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">\n        <path\n            style="fill:var(--fill-color, currentcolor);stroke-linecap:round;stroke-linejoin:round;-inkscape-stroke:none;paint-order:markers stroke fill"\n            d="M 5.484375 0.43359375 A 1.5224222 1.5224222 0 0 0 4.2558594 1.2011719 L 0.99804688 6.9453125 A 1.5224222 1.5224222 0 0 0 2.5488281 9.2011719 L 9.34375 8.171875 A 1.5224222 1.5224222 0 0 0 10.332031 5.7539062 L 9.4746094 4.6113281 C 11.949333 3.8016718 14.718209 4.258351 16.822266 5.9570312 C 19.510764 8.1275534 20.456787 11.785479 19.160156 14.988281 C 17.863527 18.191083 14.6405 20.15873 11.199219 19.847656 C 7.7579362 19.536584 4.9376009 17.022073 4.2363281 13.638672 A 1.5 1.5 0 0 0 2.4628906 12.474609 A 1.5 1.5 0 0 0 1.2988281 14.248047 C 2.2656928 18.912838 6.1831413 22.407052 10.927734 22.835938 C 15.672328 23.264824 20.153706 20.531029 21.941406 16.115234 C 23.729107 11.699441 22.413741 6.6156073 18.707031 3.6230469 C 16.853677 2.1267667 14.61485 1.3255701 12.347656 1.2324219 C 10.738216 1.1662975 9.1150542 1.4598646 7.6035156 2.1132812 L 6.7988281 1.0390625 A 1.5224222 1.5224222 0 0 0 5.484375 0.43359375 z " />\n    </svg>\n    <svg id="icon-definition_cancel" class="icon cancel" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">\n    <path\n        style="fill:var(--fill-color, currentcolor);stroke-linecap:round;stroke-linejoin:round;-inkscape-stroke:none;paint-order:markers stroke fill"\n        d="M -7.063234 9.5244002 C -5.8135728 7.6769245 -5.0820528 5.453265 -5.0820528 3.0633809 C -5.0820529 -3.3096433 -10.278145 -8.5098163 -16.65117 -8.5098163 C -23.024193 -8.5098163 -28.22385 -3.3110105 -28.22385 3.0620137 C -28.22385 9.4350379 -23.025043 14.634694 -16.65202 14.634694 C -12.668879 14.634694 -9.1460028 12.603526 -7.063234 9.5244002 z M -9.5406311 7.8637601 C -11.076991 10.143147 -13.683157 11.63463 -16.652974 11.63463 C -19.960499 11.63463 -22.814085 9.782061 -24.244824 7.0543029 L -24.236684 7.0527515 L -8.1332524 3.983715 L -8.1305391 3.9831979 C -8.2815631 5.4121635 -8.7798709 6.7350751 -9.5406311 7.8637601 z M -9.0610781 -0.92890828 L -9.069218 -0.92735695 L -25.17265 2.1416796 L -25.175363 2.1421967 C -24.719122 -2.1725739 -21.093311 -5.5092358 -16.652928 -5.5092358 C -13.345403 -5.5092358 -10.491243 -3.6566663 -9.0610781 -0.92890828 z "\n        transform="rotate(-124.20981)" />\n    </svg>\n</div>',this.shadowRoot.adoptedStyleSheets.push(c)}connectedCallback(){this.#i()}disconnectedCallback(){this.#l()}#c=!1;#u=!1;async#i(){1!=this.#c&&1!=this.#u&&(this.#c=!0,i(this.shadowRoot),this.addEventListener("click",this.#d),this.findElement("#enabled").addEventListener("change",this.#h),await new Promise(e=>requestAnimationFrame(()=>{this.#o=new r(this),this.#u=!0,this.#c=!1;if(0==this.dispatchEvent(new CustomEvent(t.Init,{bubbles:!0,composed:!0,cancelable:!0,detail:{target:this}})))return void e();"false"!=this.getAttribute("auto")?(this.reloadTests(),e()):e()})))}#l(){this.removeEventListener("click",this.#d),this.findElement("#enabled").removeEventListener("change",this.#h),this.#u=!1,this.#c=!1}#d=this.#p.bind(this);#p(t){if(null!=t.composedPath().find(t=>t instanceof HTMLButtonElement&&"run-all-button"==t.id))return void(this.classList.contains("running")?this.cancel():this.classList.contains("fail")||this.classList.contains("success")?this.reset():this.runTests());null!=t.composedPath().find(t=>t instanceof HTMLButtonElement&&"reload-button"==t.id)&&this.reloadTests();const e=t.composedPath().find(t=>t instanceof HTMLButtonElement&&t.classList.contains("run-test-button"));if(null==e)return;const n=e.closest("code-test")??void 0;this.#o.runTest(n,!1)}#h=this.#f.bind(this);#f(e){const n=e.target;0==this.dispatchEvent(new CustomEvent(t.Enabled,{bubbles:!0,composed:!0,cancelable:!0,detail:{target:this}}))&&(e.preventDefault(),e.stopPropagation(),n.checked=!n.checked)}#g(){return this.getAttribute("src")??this.getAttribute("test")??this.getAttribute("tests")??this.getAttribute("run")??this.getAttribute("path")??void 0}#t(){const t=this.getIsRunning(),e=this.getResultCategory(),n=null!=this.state.beforeAllState,s=null!=this.state.beforeEachState,r=null!=this.state.requiredAfterAnyState,a=null!=this.state.beforeAllState,o=null!=this.state.beforeEachState,i=null!=this.state.requiredAfterAnyState,l=1==r||1==n||1==s,c=1==i||1==a||1==o;this.classList.toggle("canceled",this.state.isCanceled),this.part.toggle("canceled",this.state.isCanceled),this.classList.toggle("running",1==t),this.part.toggle("running",1==t),this.toggleAttribute("success","success"==e),this.classList.toggle("success","success"==e),this.part.toggle("success","success"==e),this.classList.toggle("fail","fail"==e),this.part.toggle("fail","fail"==e),this.classList.toggle("has-before-hook",l),this.part.toggle("has-before-hook",l),this.classList.toggle("has-after-hook",c),this.part.toggle("has-after-hook",c),this.classList.toggle("has-before-all-hook",n),this.part.toggle("has-before-all-hook",n),this.classList.toggle("has-after-all-hook",a),this.part.toggle("has-after-all-hook",a),this.classList.toggle("has-before-each-hook",s),this.part.toggle("has-before-each-hook",s),this.classList.toggle("has-after-each-hook",o),this.part.toggle("has-after-each-hook",o),this.classList.toggle("has-required-before-hook",r),this.part.toggle("has-required-before-hook",r),this.classList.toggle("has-required-after-hook",i),this.part.toggle("has-required-after-hook",i);const u=this.findElement(".run-all-button-label");null!=u&&(u.textContent=1==t?"Cancel":"fail"==e||"success"==e?"Reset":"Run Tests",u.title=1==t?"Cancel the testing":"fail"==e||"success"==e?"Reset the tests so they can be run again":"Run the tests");const d=this.findElement(".run-all-button-icon");null!=d&&(d.innerHTML=1==t?'<use href="#icon-definition_cancel"></use>':"fail"==e||"success"==e?'<use href="#icon-definition_reset"></use>':'<use href="#icon-definition_arrow"></use>'),this.#m(this.state.beforeAllState,"#before-all-results"),this.#m(this.state.afterAllState,"#after-all-results"),this.#m(this.state.requiredBeforeAnyState,"#required-before-any-results"),this.#m(this.state.requiredAfterAnyState,"#required-after-any-results");const h=this.findElement("#title");null!=h&&(h.textContent=this.getAttribute("label")??"Tests"),this.#b()}#m(t,e){const n=this.findElement(e);t?.resultContent instanceof HTMLElement?n.append(t.resultContent):"string"==typeof t?.resultContent&&(n.innerHTML=t.resultContent);const s=n.closest("details");s.toggleAttribute("open",null!=t&&"none"!=t.resultCategory),s.classList.toggle("running",1==t?.isRunning),s.part.toggle("running",1==t?.isRunning),s.toggleAttribute("success","success"==t?.resultCategory),s.classList.toggle("success","success"==t?.resultCategory),s.part.toggle("success","success"==t?.resultCategory),s.classList.toggle("fail","fail"==t?.resultCategory),s.part.toggle("fail","fail"==t?.resultCategory)}#b(){const t=this.collectTestResults(),e=this.findElement("#results-progress-value");null!=e&&(e.max=t.totalTests,e.value=t.totalPassed);const n=this.findElement("#total-tests-passed-value");null!=n&&(n.textContent=t.totalPassed.toString());const s=this.findElement("#total-tests-count-value");null!=s&&(s.textContent=t.totalTests.toString());const r=this.findElement("#passed-total-percent-value");null!=r&&(r.textContent=t.totalPercentage.toFixed(1));const a=this.findElement("#duration-value");null!=a&&(a.textContent=t.duration>10?t.duration.toFixed(0):t.duration.toFixed(2))}collectTestResults(){const t=this.findElements("code-test"),e=t.length,n=t.filter(t=>"success"==t.state.testState?.resultCategory).length;return{totalTests:e,totalPassed:n,totalPercentage:0==e?0:n/e*100,duration:t.reduce((t,e,n)=>t+(e.state.testState?.duration??0),0)}}async runTests(){const t=this.findElements("code-test");return this.#o.runTests(t)}async reloadTests(){this.findElement("#tests").innerHTML="",await this.reset();const t=this.#g();this.#o.loadTests(t)}async reset(){const e=this.findElements("code-test");for(let t=0;t<e.length;t++){const n=e[t],s=null!=this.state.beforeEachState?{resultCategory:"none",resultContent:"",hasRun:this.state.beforeEachState.hasRun,isRunning:this.state.beforeEachState.isRunning,duration:0}:void 0,r=null!=this.state.afterEachState?{resultCategory:"none",resultContent:"",hasRun:this.state.afterEachState.hasRun,isRunning:this.state.afterEachState.isRunning,duration:0}:void 0;null!=s&&(n.state.beforeEachState=s),null!=r&&(n.state.afterEachState=r),n.reset()}const n=null==this.state.beforeAllState?void 0:{resultContent:"",resultCategory:"none",test:this.state.beforeAllState.test,isRunning:!1,hasRun:!1,duration:0},s=null==this.state.afterAllState?void 0:{resultContent:"",resultCategory:"none",test:this.state.afterAllState.test,isRunning:!1,hasRun:!1,duration:0},r=null==this.state.beforeEachState?void 0:{resultContent:"",resultCategory:"none",test:this.state.beforeEachState.test,isRunning:!1,hasRun:!1,duration:0},a=null==this.state.afterEachState?void 0:{resultContent:"",resultCategory:"none",test:this.state.afterEachState.test,isRunning:!1,hasRun:!1,duration:0},o=null==this.state.requiredBeforeAnyState?void 0:{resultContent:"",resultCategory:"none",test:this.state.requiredBeforeAnyState.test,isRunning:!1,hasRun:!1,duration:0},i=null==this.state.requiredAfterAnyState?void 0:{resultContent:"",resultCategory:"none",test:this.state.requiredAfterAnyState.test,isRunning:!1,hasRun:!1,duration:0};this.setStateProperties({isCanceled:!1,beforeAllState:n,afterAllState:s,beforeEachState:r,afterEachState:a,requiredAfterAnyState:i,requiredBeforeAnyState:o}),this.#o.shouldContinueRunningTests=!0,null!=this.state.resetHook&&await this.state.resetHook(await this.#o.createTestContext()),this.dispatchEvent(new CustomEvent(t.Reset,{bubbles:!0,composed:!0}))}cancel(){this.state.isCanceled=!0,this.#o.shouldContinueRunningTests=!1,this.classList.add("canceled"),this.part.add("canceled"),this.dispatchEvent(new CustomEvent(t.Cancel,{bubbles:!0,composed:!0}))}static observedAttributes=["open","label"];attributeChangedCallback(t,e,n){if("open"==t)this.findElement("#component-details").toggleAttribute("open",null!=n);else if("label"==t){const t=this.findElement("#title");null!=t&&(t.textContent=n??"Tests")}}}function h(t){return new a(async(e,n)=>{if(t instanceof Promise){return void e(await t)}e(t)})}async function p(e,n,s){const r=e.codeTestsElement;let a=null;const o=await new Promise((o,i)=>{const l=s?.template??r.querySelector(".prompt-template")??r.findElement("#prompt-template");a=f(l),a.querySelector(".label").textContent=n;const c=t=>{const e=t.composedPath();if(null!=e.find(t=>t instanceof HTMLButtonElement&&t.classList.contains("accept"))){const t=s?.onAccept?.()??!0;return a.removeEventListener("click",c),void o(t)}if(null!=e.find(t=>t instanceof HTMLButtonElement&&t.classList.contains("reject"))){const t=s?.onReject?.()??!1;return a.removeEventListener("click",c),void o(t)}};a.addEventListener("click",c),null!=s?.acceptLabel&&(a.querySelector(".accept").textContent=s.acceptLabel),null!=s?.rejectLabel&&(a.querySelector(".reject").textContent=s.rejectLabel),r.dispatchEvent(new CustomEvent(t.PromptInject,{bubbles:!0,composed:!0,detail:{codeTestElement:e.testElement,promptElement:a}}));const u=s?.parentElement??e.testElement?.getMessageElement();u?.append(a)});return null!=a&&a.remove(),r.dispatchEvent(new CustomEvent(t.PromptResult,{bubbles:!0,composed:!0,detail:{target:r,result:o}})),o}function f(t,e){const n=t instanceof HTMLTemplateElement?t:document.querySelector(t);if(null==n)throw new Error(`Unable to find template element from selector: ${t}`);const s=n.content.cloneNode(!0).firstElementChild;if(null==s)throw new Error("Unable to find first child of template element");return e?.append(s),s}null==customElements.get(u)&&customElements.define(u,d);const g=":not(slot,defs,g,rect,path,circle,ellipse,line,polygon,text,tspan,use,svg image,svg title,desc,template,template *)";function m(t){!function(t){const e=[...t.querySelectorAll(`${g}[id]`)];for(let t=0;t<e.length;t++)e[t].part.add(e[t].id)}(t),function(t){const e=[...t.querySelectorAll(`${g}[class]`)];for(let t=0;t<e.length;t++)e[t].part.add(...e[t].classList)}(t)}function b(t,e=!1,n){const s=function(t,e=!1){const n=new Set([...t.querySelectorAll("[part]")].map(t=>{let e=[...t.part.values()].filter(t=>null!=t).map(t=>t);const n=t.getAttribute("exportparts");if(null!=n){const t=n.replaceAll(/[\s\n]/g,"").split(",").map(t=>-1==t.indexOf(":")?t:t.split(":")[1]);e=e.concat(...t)}return e}).flat().filter(t=>t.length>0));return Array.from(n).join(","+(1==e?"\n":""))}(t,e),r=t.host.getAttribute("exportparts");t.host.setAttribute("exportparts",`${null==r?"":`${r},`}${s}`)}const v=new CSSStyleSheet;v.replaceSync("\n    :host\r\n{\r\n    --gap: 7px;\r\n    --gap-small: 3px;\r\n    --gap-medium: 14px;\r\n    --gap-large: 24px;\r\n    \r\n    --surface-success: oklch(93.96% 0.05 148.74);\r\n    --primary-success: oklch(58.83% 0.158 145.05);\r\n    --border-success: solid 1px var(--primary-success);\r\n\r\n    --surface-fail: oklch(88.98% 0.052 3.28);\r\n    --primary-fail: oklch(45.8% 0.177 17.7);\r\n    --border-fail: solid 1px var(--primary-fail);\r\n\r\n    --surface-process: oklch(89.66% 0.046 260.67);\r\n    --primary-process: oklch(43.48% 0.17 260.2);\r\n    --border-process: solid 1px var(--primary-process);\r\n\r\n    --surface-footer: rgb(0 0 0 / .04);\r\n    \r\n    --success-icon: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path fill=\"%232e943a\" d=\"M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z\"/></svg>');\r\n    --info-icon: url('data:image/svg+xml,%3Csvg%20viewBox%3D%220%200%2022.812714%2022.814663%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Asvg%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20style%3D%22fill%3Atransparent%3Bstroke%3Atransparent%3Bstroke-width%3A0.999999%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A6.3%3Bstroke-dasharray%3Anone%3Bstroke-dashoffset%3A29.2913%3Bstroke-opacity%3A1%22%20d%3D%22M%2022.295505%2C11.407332%20A%2010.889144%2C10.889144%200%200%201%2011.406424%2C22.296479%2010.889144%2C10.889144%200%200%201%200.51720881%2C11.407332%2010.889144%2C10.889144%200%200%201%2011.406424%2C0.51818382%2010.889144%2C10.889144%200%200%201%2022.295505%2C11.407332%20Z%22%3E%3C%2Fpath%3E%3Cpath%20d%3D%22m%2013.945668%2C4.3053761%20c%200.150778%2C-0.96462%20-0.30687%2C-1.43709%20-1.36997%2C-1.43709%20-1.063%2C0%20-1.668452%2C0.47247%20-1.81923%2C1.43709%20-0.150779%2C0.96462%200.306971%2C1.43708%201.369971%2C1.43708%201.004%2C0%201.66845%2C-0.47246%201.819229%2C-1.43708%20z%20M%2011.693889%2C17.829726%2013.373994%2C7.0811161%20h%20-2.9333%20L%208.7605887%2C17.829726%20Z%22%20style%3D%22font-size%3A19.6861px%3Bfont-family%3APassageway%3B-inkscape-font-specification%3APassageway%3Bfill%3A%23a30d30%3Bstroke-width%3A2.5%3Bstroke-linejoin%3Around%3Bstroke-miterlimit%3A6.3%3Bstroke-dashoffset%3A29.2913%22%20aria-label%3D%22i%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E');\r\n\r\n\r\n    color-scheme: light dark;\r\n    display: grid;\r\n    grid-template-columns: 400px 1fr;\r\n    overflow: hidden;\r\n    font-size: var(--font-size, 12px);\r\n    font-family: sans-serif;\r\n}\r\n@media (prefers-color-scheme: dark) \r\n{\r\n    :host\r\n    {\r\n        --surface-footer: rgb(255 255 255 / .1);\r\n    }\r\n}\r\n\r\n#app-panel\r\n{\r\n    display: grid;\r\n    grid-template-rows: auto auto 1fr auto;\r\n    margin: 0;\r\n    padding: 0;\r\n    overflow: hidden;\r\n    gap: var(--gap);\r\n    border-top: solid 1px;\r\n}\r\n\r\n#app-header\r\n{\r\n    display: grid;\r\n    gap: var(--gap-small);\r\n    padding: var(--gap-small);\r\n    margin: var(--gap) var(--gap) 0 var(--gap);\r\n    font-size: var(--font-size-header, var(--font-size, 14px));\r\n    font-weight: bold;\r\n    text-transform: uppercase;\r\n    border-bottom: solid 2px;\r\n}\r\n\r\n\r\n/* Dropdown Markers */\r\nsummary\r\n{\r\n    display: flex;\r\n    align-items: center;\r\n    gap: var(--gap);\r\n}\r\nsummary > .arrow-icon\r\n{\r\n    background: var(--arrow-icon);\r\n    transform: rotate(-90deg);\r\n    transition: transform ease-out 90ms;\r\n    width: .6em;\r\n    height: .6em;\r\n}\r\ndetails[open] > summary > .arrow-icon\r\n{\r\n    transform: rotate(0);\r\n}\r\nbutton .reset-icon\r\n{\r\n    width: 1em;\r\n    height: 1em;\r\n    transform: scaleX(-1);\r\n    margin-inline: 3px;\r\n}\r\n\r\n#analyst-queue\r\n{\r\n    margin-inline: var(--gap);\r\n}\r\n#analyst-queue .message\r\n{\r\n    text-align: center;\r\n    font-style: italic;\r\n    padding: var(--gap-medium);\r\n    margin: var(--gap);\r\n    color: gray;\r\n    border: solid 1px;\r\n    border-radius: 3px;\r\n}\r\n#analyst-queue .message:has(+*)\r\n{\r\n    display: none;\r\n}\r\n\r\n#test-groups\r\n{\r\n    display: grid;\r\n    grid-template-rows: auto 1fr auto;\r\n    overflow: hidden;\r\n    margin-inline: var(--gap);\r\n}\r\n\r\n#test-groups-header\r\n{\r\n    display: grid;\r\n    gap: var(--gap);\r\n    grid-template-columns: auto 1fr auto;\r\n    align-items: center;\r\n    padding-block: var(--gap);\r\n    font-weight: bold;\r\n    text-transform: uppercase;\r\n    border-bottom: solid 1px;\r\n    margin-bottom: var(--gap);\r\n}\r\n\r\n#test-group-items\r\n{\r\n    overflow-y: auto;\r\n    padding-inline: var(--gap-small);\r\n}\r\n\r\ncode-tests::part(highlight)\r\n{\r\n    background: highlight;\r\n    color: highlighttext;\r\n}\r\n\r\n/* Run button */\r\nbutton .arrow-icon\r\n{\r\n    width: .75em;\r\n    height: .75em;\r\n    transform: rotate(-90deg);\r\n    margin-inline: 3px;\r\n}\r\n\r\n\r\n#footer\r\n{\r\n    display: flex;\r\n    padding-inline:var(--gap);\r\n    margin-top: var(--gap);\r\n    border-top: solid 1px;\r\n    background: var(--surface-footer);\r\n}\r\n#footer > .container\r\n{\r\n    flex: 1;\r\n    display: flex;\r\n    justify-content: flex-end;\r\n    padding: var(--gap);\r\n}\r\n#group-results\r\n{\r\n    display: flex;\r\n    gap: var(--gap-small);\r\n}\r\n#results-progress-value\r\n{\r\n    min-width: 40px;\r\n    width: auto;\r\n}\r\n\r\n#duration\r\n,#passed-total-pair\r\n,#passed-total-percent\r\n{\r\n    white-space: nowrap;\r\n}\r\n\r\n#passed-total-percent::before\r\n{\r\n    content: '(';\r\n}\r\n#passed-total-percent::after\r\n{\r\n    content: ')';\r\n}\r\n\r\n\r\n/* Result Icon */\r\n.result-icon\r\n{\r\n    --background-size: 16px;\r\n    width: var(--background-size);\r\n    height: var(--background-size);\r\n\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n\r\n    border: solid 1px currentColor;\r\n    border-radius: 50%;\r\n}\r\n.result-icon::before\r\n{\r\n    content: 'â‹¯';\r\n    font-size: 10px;\r\n}\r\n\r\n:host(.running) #component-result-icon\r\n{\r\n    border: var(--border-process);\r\n    background: var(--surface-process);\r\n}\r\n:host(.success) #component-result-icon\r\n{\r\n    border: var(--border-success);\r\n    background: var(--surface-success)\r\n    var(--success-icon);\r\n    background-repeat: no-repeat;\r\n    background-position: center;\r\n    background-size: var(--icon-size, 12px) var(--icon-size, 12px);\r\n}\r\n:host(.fail) #component-result-icon\r\n{\r\n    border: var(--border-fail);\r\n    background: var(--surface-fail)\r\n    var(--info-icon);\r\n    background-size: var(--icon-size, 16px) var(--icon-size, 16px);\r\n    background-repeat: no-repeat;\r\n    background-position: center;\r\n    transform: rotate(175deg);\r\n}\r\n:host(:is(.success,.fail)) #component-result-icon::before\r\n{\r\n    display: none;\r\n}\r\n:host(.running) #component-result-icon::before\r\n{\r\n    content: '';\r\n    --color: var(--primary-process, currentColor);\r\n    --animation-timing-function: linear;\r\n    --animation-duration: 2s;\r\n    width: var(--icon-size, 14px);\r\n    height: var(--icon-size, 14px);\r\n    mask-image: radial-gradient(circle at 50% 50%, transparent calc(var(--icon-size, 14px) / 3), black calc(var(--icon-size, 14px) / 3));\r\n    background-image: conic-gradient(transparent, transparent 135deg, var(--color));\r\n    border-radius: 50%;\r\n    animation: var(--animation-timing-function) var(--animation-duration) infinite spin;\r\n    margin: 2px;\r\n}\r\n\r\n@media (min-width: 665px) \r\n{\r\n    #app-panel\r\n    {\r\n        border-top: none;\r\n        border-right: solid 1px;\r\n    }\r\n}\r\n\r\n@media (max-width: 665px) \r\n{\r\n    :host\r\n    {\r\n        grid-template-columns: 1fr;\r\n    }\r\n}\r\n@keyframes spin\r\n{\r\n    from { transform: rotate(0deg); }\r\n    to { transform: rotate(360deg); }\r\n}");const y="test-runner";class C extends HTMLElement{state={isCanceled:!1,isRunning:!1};setState(t){this.state=t,this.#t()}setStateProperties(t){this.setState({...this.state,...t})}findElement(t){return this.shadowRoot.querySelector(t)}findElements(t){return Array.from(this.shadowRoot.querySelectorAll(t))}constructor(){super(),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML='<div id="app-panel" class="panel">\r\n    <header id="app-header">\r\n        <div id="title">Test Runner</div>\r\n        <div id="app-options" class="options">\r\n\r\n        </div>\r\n    </header>\r\n    <details id="analyst-queue">\r\n        <summary id="analyst-queue-summary">\r\n            <svg class="icon arrow-icon"><use href="#icon-definition_arrow"></use></svg>\r\n            <span id="analyst-queue-title" class="title">Analyst Queue</span>\r\n        </summary>\r\n        <div id="analyst-queue-items" class="items">\r\n            <div class="message">The analyst queue will be populated by any unanswered prompts that have been invoked by the tests.</div>\r\n        </div>\r\n    </details>\r\n    <div id="test-groups">\r\n        <header id="test-groups-header">\r\n            <span id="component-result-icon" class="result-icon"></span>\r\n            <span id="test-groups-title" class="title">Tests</span>\r\n            <button type="button" id="run-all">\r\n                <svg class="icon arrow-icon run-button-icon run-all-button-icon"><use href="#icon-definition_arrow"></use></svg>\r\n                <span id="run-button-label" class="button-label label icon">Run All Tests</span>\r\n            </button>\r\n        </header>\r\n        <div id="test-group-items" class="items"></div>\r\n    </div>\r\n    \r\n    <foooter id="footer">\r\n        <div class="container">\r\n            <span id="group-results">\r\n                <span id="duration">\r\n                    <span id="duration-label">Duration:</span>\r\n                    <span id="duration-value">0</span>\r\n                    <span id="duration-unit">ms</span>\r\n                </span>\r\n                <span id="results-progress">\r\n                    <progress id="results-progress-value"></progress>\r\n                </span>\r\n                <span id="passed-total-pair">\r\n                    <span id="total-tests-passed-value"></span>\r\n                    <span id="passed-total-delimiter">of</span>\r\n                    <span id="total-tests-count-value"></span>\r\n                    <span id="total-tests-passed-label">Passed</span>\r\n                </span>\r\n                <span id="passed-total-percent">\r\n                    <span id="passed-total-percent-value">0</span>\r\n                    <span id="passed-total-percent-label">%</span>\r\n                </span>\r\n            </span>\r\n        </div>\r\n    </foooter>\r\n\r\n    \x3c!-- <footer id="app-footer">\r\n        <div id="app-results" class="results">\r\n            <div id="passing-results" class="pill">\r\n                <div id="passing-title" class="title">\r\n                    <span id="passing-color" class="color"></span>\r\n                    <span id="passing-label" class="label">Passing</span>\r\n                </div>\r\n                <div class="value"></div>\r\n            </div>\r\n            <div id="percentage">\r\n                <div class="pass"></div>\r\n                <div class="fail"></div>\r\n                <div class="skip"></div>\r\n                <div class="running"></div>\r\n            </div>\r\n        </div>\r\n    </footer> --\x3e\r\n</div>\r\n<div id="subject">\r\n    <slot id="subject-slot"></slot>\r\n</div>\r\n<template id="prompt-template">\r\n    <div class="prompt-list-item">\r\n        <header class="prompt-header">\r\n            <span class="title">Prompt from:</span>\r\n            <span class="test-link">[unknown]</span>\r\n        </header>\r\n    </div>\r\n</template>\r\n<div id="icon-definitions" style="display: none;">\r\n    <svg id="icon-definition_arrow" viewBox="0 0 8 8" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">\r\n        <path d="m3.26,6.81l-2.93,-4.69c-0.37,-0.58 0.05,-1.34 0.74,-1.34l5.87,0c0.69,0 1.11,0.76 0.74,1.34l-2.93,4.69c-0.35,0.55 -1.14,0.55 -1.49,0z" fill="var(--fill-color, currentcolor)" />\r\n    </svg>\r\n    <svg id="icon-definition_reset" class="icon reset" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">\r\n        <path\r\n            style="fill:var(--fill-color, currentcolor);stroke-linecap:round;stroke-linejoin:round;-inkscape-stroke:none;paint-order:markers stroke fill"\r\n            d="M 5.484375 0.43359375 A 1.5224222 1.5224222 0 0 0 4.2558594 1.2011719 L 0.99804688 6.9453125 A 1.5224222 1.5224222 0 0 0 2.5488281 9.2011719 L 9.34375 8.171875 A 1.5224222 1.5224222 0 0 0 10.332031 5.7539062 L 9.4746094 4.6113281 C 11.949333 3.8016718 14.718209 4.258351 16.822266 5.9570312 C 19.510764 8.1275534 20.456787 11.785479 19.160156 14.988281 C 17.863527 18.191083 14.6405 20.15873 11.199219 19.847656 C 7.7579362 19.536584 4.9376009 17.022073 4.2363281 13.638672 A 1.5 1.5 0 0 0 2.4628906 12.474609 A 1.5 1.5 0 0 0 1.2988281 14.248047 C 2.2656928 18.912838 6.1831413 22.407052 10.927734 22.835938 C 15.672328 23.264824 20.153706 20.531029 21.941406 16.115234 C 23.729107 11.699441 22.413741 6.6156073 18.707031 3.6230469 C 16.853677 2.1267667 14.61485 1.3255701 12.347656 1.2324219 C 10.738216 1.1662975 9.1150542 1.4598646 7.6035156 2.1132812 L 6.7988281 1.0390625 A 1.5224222 1.5224222 0 0 0 5.484375 0.43359375 z " />\r\n    </svg>\r\n    <svg id="icon-definition_cancel" class="icon cancel" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg">\r\n    <path\r\n        style="fill:var(--fill-color, currentcolor);stroke-linecap:round;stroke-linejoin:round;-inkscape-stroke:none;paint-order:markers stroke fill"\r\n        d="M -7.063234 9.5244002 C -5.8135728 7.6769245 -5.0820528 5.453265 -5.0820528 3.0633809 C -5.0820529 -3.3096433 -10.278145 -8.5098163 -16.65117 -8.5098163 C -23.024193 -8.5098163 -28.22385 -3.3110105 -28.22385 3.0620137 C -28.22385 9.4350379 -23.025043 14.634694 -16.65202 14.634694 C -12.668879 14.634694 -9.1460028 12.603526 -7.063234 9.5244002 z M -9.5406311 7.8637601 C -11.076991 10.143147 -13.683157 11.63463 -16.652974 11.63463 C -19.960499 11.63463 -22.814085 9.782061 -24.244824 7.0543029 L -24.236684 7.0527515 L -8.1332524 3.983715 L -8.1305391 3.9831979 C -8.2815631 5.4121635 -8.7798709 6.7350751 -9.5406311 7.8637601 z M -9.0610781 -0.92890828 L -9.069218 -0.92735695 L -25.17265 2.1416796 L -25.175363 2.1421967 C -24.719122 -2.1725739 -21.093311 -5.5092358 -16.652928 -5.5092358 C -13.345403 -5.5092358 -10.491243 -3.6566663 -9.0610781 -0.92890828 z "\r\n        transform="rotate(-124.20981)" />\r\n    </svg>\r\n</div>\n',this.shadowRoot.adoptedStyleSheets.push(v)}connectedCallback(){this.#i()}disconnectedCallback(){this.#l()}#i(){this.addEventListener("click",this.#d),this.addEventListener(t.Init,this.#v),this.addEventListener(t.Enabled,this.#h),this.addEventListener(t.AfterTest,this.#y),this.addEventListener(t.PromptInject,this.#C);this.findElement("#subject-slot").addEventListener("slotchange",this.#E),function(t){const e=[...t.querySelectorAll(`${g}`)];for(let t=0;t<e.length;t++){const n=e[t].tagName.toLowerCase();e[t].part.add(n)}}(this.shadowRoot),m(this.shadowRoot),b(this.shadowRoot)}#l(){this.removeEventListener("click",this.#d),this.removeEventListener(t.Init,this.#v),this.removeEventListener(t.Enabled,this.#h),this.removeEventListener(t.AfterTest,this.#y),this.removeEventListener(t.PromptInject,this.#C);this.findElement("#subject-slot").removeEventListener("slotchange",this.#E)}#t(){const t=this.state.isRunning,e=this.getResultCategory();this.classList.toggle("canceled",this.state.isCanceled),this.part.toggle("canceled",this.state.isCanceled),this.classList.toggle("running",1==t),this.part.toggle("running",1==t),this.toggleAttribute("success","success"==e),this.classList.toggle("success","success"==e),this.part.toggle("success","success"==e),this.classList.toggle("fail","fail"==e),this.part.toggle("fail","fail"==e);const n=this.findElement("#run-button-label");null!=n&&(n.textContent=1==t?"Cancel":"fail"==e?"Reset":"Run All Tests",n.title=1==t?"Cancel the testing":"fail"==e?"Reset the tests so they can be run again":"Run the tests");const s=this.findElement(".run-all-button-icon");null!=s&&(s.innerHTML=1==t?'<use href="#icon-definition_cancel"></use>':"fail"==e?'<use href="#icon-definition_reset"></use>':'<use href="#icon-definition_arrow"></use>')}#b(){const t=this.collectTestResults(),e=this.findElement("#results-progress-value");null!=e&&(e.max=t.totalTests,e.value=t.totalPassed);const n=this.findElement("#total-tests-passed-value");null!=n&&(n.textContent=t.totalPassed.toString());const s=this.findElement("#total-tests-count-value");null!=s&&(s.textContent=t.totalTests.toString());const r=this.findElement("#passed-total-percent-value");null!=r&&(r.textContent=t.totalPercentage.toFixed(1));const a=this.findElement("#duration-value");null!=a&&(a.textContent=t.duration>10?t.duration.toFixed(0):t.duration.toFixed(2))}collectTestResults(){const t=this.findElements("code-tests");let e=0,n=0,s=0,r=0;for(let s=0;s<t.length;s++){const a=t[s].collectTestResults();e+=a.totalTests,n+=a.totalPassed,r+=a.duration}s=0==e?0:n/e*100;return{totalTests:e,totalPassed:n,totalPercentage:s,duration:r}}async runAllTests(){const t=this.findElements("code-tests"),e="false"!=this.getAttribute("ordered");if(this.setStateProperties({isRunning:!0}),1==e)for(let e=0;e<t.length;e++){if(1==this.state.isCanceled)continue;0!=t[e].findElement("#enabled").checked&&await t[e].runTests()}else{const e=[];for(let n=0;n<t.length;n++){0!=t[n].findElement("#enabled").checked&&e.push(t[n].runTests())}await Promise.allSettled(e)}this.setStateProperties({isRunning:!1})}getResultCategory(){return this.findElements("code-tests").reduce((t,e,n)=>{const s=e.getResultCategory();return"fail"==t||"fail"==s?"fail":"success"!=t&&""!=t||"success"!=s?"none":"success"},"")}async reset(){const t=this.findElements("code-tests");for(let e=0;e<t.length;e++){t[e].reset()}this.setStateProperties({isCanceled:!1,isRunning:!1})}cancel(){const t=this.findElements("code-tests");for(let e=0;e<t.length;e++){t[e].cancel()}this.classList.add("canceled"),this.part.add("canceled"),this.setStateProperties({isCanceled:!0,isRunning:!1})}getPromptParent(){return this.findElement("#analyst-queue-items")}toggleAnalystQueueOpen(t){t=t??!0,this.findElement("#analyst-queue").open=t}#w=new Map;#v=this.#S.bind(this);async#S(t){t.preventDefault();const e=t.detail.target;let n=this.#w.get(e);null==n?(n={isLoaded:!1,enabled:e.findElement("#enabled").checked},this.#w.set(e,n)):0==n.isLoaded&&(await e.reloadTests(),e.toggleAttribute("optional",!0),n.isLoaded=!0,this.#w.set(e,n))}#E=this.#k.bind(this);#k(t){const e=this.findElement("#subject-slot").assignedElements().filter(t=>t instanceof d);this.findElement("#test-group-items").append(...e)}#d=this.#p.bind(this);async#p(t){null==t.composedPath().filter(t=>t instanceof HTMLElement).find(t=>t instanceof HTMLButtonElement&&"run-all"==t.id)||(this.classList.contains("running")?this.cancel():this.classList.contains("fail")||this.classList.contains("success")?this.reset():this.runAllTests())}#h=this.#A.bind(this);#A(t){const e=t.detail.target;if(null==this.#w.get(e))throw new Error("Cannot update element enabled state: Element state not found.")}#y=this.#x.bind(this);#x(t){this.#b()}#C=this.#T.bind(this);#T(t){const e=t,n=e.detail.promptElement,s=e.detail.codeTestElement,r=f(this.findElement("#prompt-template")),a=r.querySelector(".test-link");a.addEventListener("click",()=>{let t=s.closest("details");for(;null!=t;)t.toggleAttribute("open",!0),t=t.parentElement?.closest("details")??null;s.part.add("highlight"),s.scrollIntoView(),setTimeout(()=>{s.part.remove("highlight")},3e3)}),a.dataset.testId=s.state.testId,a.textContent=s.state.description??"[ unknown parent ]",n.prepend(r)}}null==customElements.get(y)&&customElements.define(y,C);export{n as CodeTestElement,t as CodeTestEvent,d as CodeTestsElement,l as Hook,a as TestPromise,C as TestRunnerElement,f as createElementFromTemplate,h as expect,p as prompt};
